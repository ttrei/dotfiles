* Claude Code

  https://docs.claude.com/en/docs/claude-code/devcontainer

  https://search.nixos.org/packages?channel=unstable&query=devcontainer
  https://github.com/devcontainers/cli

  https://console.anthropic.com/settings/keys

  https://github.com/anthropics/claude-code/tree/main/.devcontainer

  @code
  git clone https://github.com/anthropics/claude-code
  cd claude-code
  devcontainer up --workspace-folder .
  devcontainer exec --workspace-folder . claude
  @end

* Gemini CLI

  Learn how to automatically commit the conversation history:
  https://github.com/google-gemini/gemini-cli/blob/main/docs/checkpointing.md

  (done) Add uv to gemini docker image.

  (done) Try out "Beads - A memory upgrade for your coding agent"
  https://github.com/steveyegge/beads

  (done) Try to run gemini-cli in docker:
  https://geminicli.com/docs/get-started/installation/#2-run-in-a-sandbox-dockerpodman
  How to authenticate?
  Generated key here
  https://aistudio.google.com/app/api-keys
  Grok suggested how to run it
  https://grok.com/c/c2f8560d-3b05-4c5d-8ef5-ed564acd2d70
  @code
  sudo docker run --rm -it \
      -v $HOME/.gemini:/home/node/.gemini \
      -v $HOME/.gemini-api-key:/home/node/.gemini/.env \
      -v /home/reinis/dev/projects/home.taukulis.lv:/home/node/code \
      us-docker.pkg.dev/gemini-code-dev/gemini-cli/sandbox:0.10.0-preview.1 \
      /bin/bash -c "cd /home/node/code && gemini"
  @end
  Created script gemini-docker.sh

  (done) Select theme:
  https://github.com/google-gemini/gemini-cli/blob/main/docs/cli/themes.md
  ANSI Light seems ok.

  (done) Learn how to use GEMINI.md files:
  https://github.com/google-gemini/gemini-cli/blob/main/docs/cli/configuration.md#context-files-hierarchical-instructional-context

* Zen Browser

  https://github.com/zen-browser/desktop
  https://docs.zen-browser.app/user-manual

  https://github.com/0xc000022070/zen-browser-flake

* Niri

  Script to search/spawn specific application:
  https://github.com/YaLTeR/niri/discussions/352#discussioncomment-11855839
  Found it while reading comments about niri experience on HN:
  https://news.ycombinator.com/item?id=43349014

  Quickshell config recommended by @HSVSphere
  https://github.com/AvengeMedia/DankMaterialShell

* Move neovim configuration to nixvim

  https://github.com/nix-community/nixvim

  Check out this config for useful things:
  https://github.com/LGUG2Z/JeezyVim

* Try out Determinate Nix

   https://docs.determinate.systems/guides/advanced-installation/#nixos

* Secrets management

  https://secretspec.dev/

* Annoyances

** (zathura pdf reader) Handling of different page sizes

   As of version 0.5.11 zathura shows a lot of empty space around pages if there's some large page in the document.
   There's a bug:
   https://github.com/pwmt/zathura/issues/706

   I will try to use pdf.js in qutebrowser insead.
   But zathura might still be ok for reading ebooks.

** (neorg) Indentation jumps around

   ~ Create new heading
   ~ press enter, indentation is at correct level
   ~ press enter again -> no more indentation (may have to press enter multiple times to get the effect)

   After entering text and pressing escape, the text gets indented correctly.

   Maybe configure format_on_enter=false?
   https://github.com/nvim-neorg/neorg/wiki/Indent#format_on_enter
   I think the behavior will be more consistent if it formats only on exiting insert mode.

** Don't deploy python __pycache__ directories

   Either "git clean -fd" them or copy only specific files instead of directories.
   Encountered while developing workspace init scripts (dotfiles/i3/workspace-scripts).

** (skip) Migrate from transmission to rtorrent

   Used this as example on how to integrate with the flood ui:
   https://wiki.nixos.org/wiki/Rtorrent

   Registered a user in the flood ui.
   Specified socket /run/rtorrent/rpc.sock.

   Connected radarr to flood.
   https://github.com/jesec/flood/wiki/List-of-unofficial-API-integrations

   Radarr sends something to flood but it doesn't start downloading.
   Maybe because vpn not enabled?
   Have to solve the dns issues when vpn enabled.
   Update: Re-generated the wireguard config here https://mullvad.net/en/account/wireguard-config.
   Now dns seems to work.

   Maybe flood is not the way to go.
   Seems too complex and unmaintained.
   Will try to go with rutorrent https://github.com/Novik/ruTorrent.

   Managed to bring it up (port 9292).
   Left to do:
   - Connect kodi with rtorrent/rutorrent.
   - Resolve any filesystem permission issues between rtorrent and rutorrent.

   Update:
   Ran into some problems connecting kodi to rtorrent.
   The downloads also didn't start consistently.

   This was my config that barely worked:
   @code
   services.rtorrent = {
     enable = true;
     user = "reinis";
     group = "users";
     port = 51412;
     package = pkgs.jesec-rtorrent;
     openFirewall = true;
     downloadDir = "/media/Storage/rtorrent";
     configText = ''log.add_output = "debug", "log"'';
   };

   services.nginx = {
     enable = true;
     virtualHosts."myrutorrent" = {
       enableACME = false;
       addSSL = false;
       listen = [
         {
           addr = "0.0.0.0";
           port = 9292;
         }
       ];
     };
   };

   services.rutorrent = {
     enable = true;
     hostName = "myrutorrent";
     nginx.enable = true;
   };

   networking.firewall.allowedTCPPorts = [
     9292 # rutorrent UI
   ];
   networking.firewall.allowedUDPPorts = [
     6881 # rutorrent DHT
   ];
   @end

   Went back to transmission, seems to be working fine.
   Now i don't remember why i wanted to ditch transmission.

* Developer tooling

  Advice from matklad https://www.twitch.tv/videos/2336452629:
  - Work on your tools ("sharpen your axe")
  - Publish your tools
  - When using a tool, figure out how the authors *meant* it to be used, see if it works for you
  - For writing useful little scripts for yourself, the main enemy is *activation energy*

** ast-grep(sg) - CLI tool for code structural search, lint, and rewriting.

   https://github.com/ast-grep/ast-grep

   https://news.ycombinator.com/item?id=38590984

** Try out other database clients than dbeaver

   This was prompted by inability to find the dbeaver.ini settings file.

   Universal clients:
   - DbVisualizer (https://www.dbvis.com/)
   - JetBrains DataGrip (https://www.jetbrains.com/datagrip/)
   - TablePlus (https://github.com/TablePlus/TablePlus)
   - https://squirrel-sql.sourceforge.io/

   db-specific clients:
   - pgAdmin
   - MySQL Workbench

** (fzf) Browse kubernetes pods while showing logs in the preview window

   https://github.com/junegunn/fzf/blob/0e67c5aa7a7c98bc9c8b0f8bed23579136db54da/ADVANCED.md#log-tailing
   @code
   pods() {
     command='kubectl get pods --all-namespaces' fzf \
       --info=inline --layout=reverse --header-lines=1 \
       --prompt "$(kubectl config current-context | sed 's/-context$//')> " \
       --header $'╱ Enter (kubectl exec) ╱ CTRL-O (open log in editor) ╱ CTRL-R (reload) ╱\n\n' \
       --bind 'start,ctrl-r:reload:$command' \
       --bind 'ctrl-/:change-preview-window(80%,border-bottom|hidden|)' \
       --bind 'enter:execute:kubectl exec -it --namespace {1} {2} -- bash' \
       --bind 'ctrl-o:execute:${EDITOR:-vim} <(kubectl logs --all-containers --namespace {1} {2})' \
       --preview-window up:follow \
       --preview 'kubectl logs --follow --all-containers --tail=10000 --namespace {1} {2}' "$@"
   }
   @end

** (python) Try out ty

   https://github.com/astral-sh/ty

** (python) Choose ruff rules with help from AI

   https://x.com/bantg/status/1895315010294870312
   > ruff is the best python linter, but it has so many rules.
   > luckily you can analyze your project and find the best non-conflicting rules with claude.
   > i used this prompt:
   > run `ruff check src --select ALL --statistics` and then read the explanations for rules with `ruff rule XYZ` and then
   > decide which classes or rules or individual rules we keep and which we exclude (like UP017). present me your findings
   > before updating the ruff config in pyproject.toml

** (pre-commit) Exclude some python files from the ruff hooks

   I'm using https://github.com/cachix/git-hooks.nix to get pre-commit hooks.
   Here's the implementation of the ruff hook:
   https://github.com/cachix/git-hooks.nix/blob/80479b6ec16fefd9c1db3ea13aeb038c60530f46/modules/hooks.nix#L3666

   There's an official pre-commit plugin for ruff:
   https://github.com/astral-sh/ruff-pre-commit
   It uses the --force-exclude flag for ruff commands.
   @code
   --force-exclude
          Enforce exclusions, even for paths passed to Ruff directly on the command-line. Use `--no-force-exclude` to disable
   @end
   Looks like this is what i want.

   TODO: Try to create a custom hook or modify the one from git-hooks.nix - add the --force-exclude option.
   If it works as expected, create a PR in git-hooks.nix repo.

** (shell) Try out nushell

   https://github.com/nushell/nushell

** (git) Choose a good cli git interface

   https://github.com/tpope/vim-fugitive
   https://github.com/NeogitOrg/neogit
   https://github.com/jesseduffield/lazygit?tab=readme-ov-file#bisect
   https://github.com/kdheepak/lazygit.nvim

** (git) Try out mergiraf

   https://mergiraf.org/introduction.html
   https://codeberg.org/mergiraf/mergiraf

** (git) Try out difftastic

   https://difftastic.wilfred.me.uk/
   https://github.com/Wilfred/difftastic

** (neovim) Learn to use nvim-surround

   https://github.com/kylechui/nvim-surround?tab=readme-ov-file#rocket-usage

** (neovim) One shortcut to navigate many kinds of lists

   There should be a way to select which list to navigate (errors, search results, uncommitted changes, conflicts, etc.)
   And two shortcuts to actually do the navigation.
   Idea taken from matklad: https://www.twitch.tv/videos/2336452629

** (neovim) Setup for Java development

   https://ptrtojoel.dev/posts/so-you-want-to-write-java-in-neovim/
   https://news.ycombinator.com/item?id=42530991

** (done) Add some pre-commit hooks

   https://github.com/cachix/git-hooks.nix

** Tracy profiler

   A real time, nanosecond resolution, remote telemetry, hybrid frame and sampling profiler for games and other
   applications.

   https://github.com/wolfpld/tracy

* Other

** Printing on NixOS

   I attempted it before, unsuccessfully, see attic/0001-wip-printing-no-luck-yet.patch

* (skip) Try out omarchy-nix

  https://github.com/henrysipp/omarchy-nix

  First attempt - 4411f7de70aac2cf5bc56bfaa09dc32c4c09c823.
  Seems the system rebuild mostly worked:
  @code
  --> dotfiles omarchy-nix X apply-system.sh
  sudo nixos-rebuild switch --flake /home/reinis/dotfiles#jupiter
  [sudo] password for reinis:
  warning: Git tree '/home/reinis/dotfiles' is dirty
  building the system configuration...
  warning: Git tree '/home/reinis/dotfiles' is dirty
  updating GRUB 2 menu...
  Warning: os-prober will be executed to detect other bootable partitions.
  Its output will be used to detect bootable binaries on them and create new boot entries.
  lsblk: /dev/mapper/no*[0-9]: not a block device
  lsblk: /dev/mapper/raid*[0-9]: not a block device
  lsblk: /dev/mapper/disks*[0-9]: not a block device
  Found Windows Boot Manager on /dev/sdb2@/EFI/Microsoft/Boot/bootmgfw.efi
  Found Debian GNU/Linux bookworm/sid on /dev/sdb3
  Found Debian GNU/Linux trixie/sid on /dev/sdb4
  Found Debian GNU/Linux trixie/sid on /dev/sdb6
  activating the configuration...
  setting up /etc...
  reloading user units for reinis...
  restarting sysinit-reactivation.target
  the following new units were started: fstrim.service, NetworkManager-dispatcher.service
  warning: the following units failed: avahi-daemon.service
  × avahi-daemon.service - Avahi mDNS/DNS-SD Stack
       Loaded: loaded (/etc/systemd/system/avahi-daemon.service; enabled; preset: ignored)
       Active: failed (Result: exit-code) since Mon 2025-09-22 00:19:37 EEST; 360ms ago
   Invocation: 5e22bc2895b04804a7281055fdc3aa42
  TriggeredBy: ● avahi-daemon.socket
         Docs: man:avahi-daemon(8)
               man:avahi-daemon.conf(5)
               man:avahi.hosts(5)
               man:avahi.service(5)
      Process: 49206 ExecStart=/nix/store/xzzabbac24rfwzn0nyr4psyxr9kmnza8-avahi-0.8/sbin/avahi-daemon --syslog -f /nix/store/lgd6rnp205bgwp5pji3ysia4n0bd2a7l-avahi-daemon.conf (code=exited, status=255/EXCEPTION)
     Main PID: 49206 (code=exited, status=255/EXCEPTION)
           IP: 0B in, 0B out
           IO: 0B read, 0B written
     Mem peak: 2.2M
          CPU: 20ms

  Sep 22 00:19:37 jupiter systemd[1]: Starting Avahi mDNS/DNS-SD Stack...
  Sep 22 00:19:37 jupiter avahi-daemon[49206]: Process 882 died: No such process; trying to remove PID file. (/run/avahi-daemon//pid)
  Sep 22 00:19:37 jupiter avahi-daemon[49206]: Found user 'avahi' (UID 994) and group 'avahi' (GID 993).
  Sep 22 00:19:37 jupiter avahi-daemon[49206]: Successfully dropped root privileges.
  Sep 22 00:19:37 jupiter avahi-daemon[49206]: open(/run/avahi-daemon//pid): File exists
  Sep 22 00:19:37 jupiter avahi-daemon[49206]: Failed to create PID file: File exists
  Sep 22 00:19:37 jupiter systemd[1]: avahi-daemon.service: Main process exited, code=exited, status=255/EXCEPTION
  Sep 22 00:19:37 jupiter systemd[1]: avahi-daemon.service: Failed with result 'exit-code'.
  Sep 22 00:19:37 jupiter systemd[1]: Failed to start Avahi mDNS/DNS-SD Stack.
  warning: error(s) occurred while switching to the new configuration
  @end

  home-manager switch didn't work:
  @code
  --> dotfiles omarchy-nix X apply-users.sh
  home-manager switch --flake /home/reinis/dotfiles#reinis@jupiter
  warning: Git tree '/home/reinis/dotfiles' is dirty
  error:
         … while evaluating a branch condition
           at /nix/store/x06djk7jw02qb6y8fxd0mjgaksw2kd9n-source/lib/lists.nix:142:18:
            141|       len = length list;
            142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));
               |                  ^
            143|     in

         … while calling the 'length' builtin
           at /nix/store/x06djk7jw02qb6y8fxd0mjgaksw2kd9n-source/lib/lists.nix:141:13:
            140|     let
            141|       len = length list;
               |             ^
            142|       fold' = n: if n == len then nul else op (elemAt list n) (fold' (n + 1));

         … while evaluating the option `omarchy.theme':

         (stack trace truncated; use '--show-trace' to show the full, detailed trace)

         error: expected a set but found null: null
  @end

  How to run hyprland?
  Tried to run it from the still running x session, got a crash.
  Restarted the machine.
  Hyprland seemed to start up but i couldn't spawn a terminal, mouse was not visible.
  Oh, maybe it was on the other display?
  Indeed.

  @code
  sudo nixos-rebuild boot --flake $HOME/dotfiles#$(hostname) --profile-name omarchy
  @end

  Let's try out niri, seems simpler than hyprland and i want to try out the scrolling tiling wm concept.

